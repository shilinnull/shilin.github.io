## 一、面向过程和面向对象的初步认识

>C语言是面向过程的，关注的是过程，分析出求解问题的步骤，通过函数调用逐步解决问题。

![在这里插入图片描述](https://img-blog.csdnimg.cn/direct/7b11e0efe9f949649b28a7f54fbe487c.png)

- C++是基于面向对象的，关注的是对象，将一件事情拆分成**不同的对象**，靠**对象**之间的交互完成。


![在这里插入图片描述](https://img-blog.csdnimg.cn/direct/8765638f5ed24eeeb5e4a39e1cf0c334.png)

## 二、类的引入


- C语言**结构体中只能定义变量**，在C++中，**结构体内不仅可以定义变量，也可以定义函数**。比如：之前在数据结构初阶中，用C语言方式实现的**栈**，**结构体中只能定义变量**；**现在以C++方式实现，会发现struct中也可以定义函数。**
- 这里就不介绍C语言的用法了

- C++兼容C，**之前写的结构体，升级成了类**，我们来看下面的代码：

```cpp
typedef int DataType;

struct Stack
{
	// 成员函数
	void Init(size_t capacity = 4)
	{
		_array = (DataType*)malloc(sizeof(DataType) * capacity);
		if (nullptr == _array)
		{
			perror("malloc申请空间失败");
			return;
		}
		_capacity = capacity;
		_size = 0;
	}
	void Push(const DataType& data)
	{
		// 扩容
		_array[_size] = data;
		++_size;
	}
	DataType Top()
	{
		return _array[_size - 1];
	}
	void Destroy()
	{
		if (_array)
		{
			free(_array);
			_array = nullptr;
			_capacity = 0;
			_size = 0;
		}
	}
	// 成员变量
	DataType* _array;
	size_t _capacity;
	size_t _size;
};

int main()
{
	Stack s;
	s.Init(10);
	s.Push(1);
	s.Push(2);
	s.Push(3);
	cout << s.Top() << endl;
	s.Destroy();
	return 0;
}
```
- 上面结构体的定义，在`C++`中更喜欢用**class**关键字来代替。

>下面就有类的定义以及使用了
### 类的定义

```cpp
class className
{
	// 类体：由成员函数和成员变量组成
}; // 一定要注意后面的分号
```

- **class**为定义类的关键字，`ClassName`为类的名字，**{}**中为类的主体，注意类定义结束时后面分号不能省略。

- 类体中内容称为类的成员：**类中的变量称为类的属性或成员变量; 类中的函数称为类的方法或者成员函数。**


>如何写呢？

- 我们可以这样定义，定义一个**日期类**，但是我们这里推荐名字加上一个`_`，便于区分，为什么呢？
```cpp
class Date
{
	int year;
	int month;
	int day;
};
```

- 再来看下面的代码，是不是就分不清楚了~~
```cpp
class Date
{
	void Init(int year,int month,int day)
	{
		year = year;
		month = month;
		day = day;
	}
	int year;
	int month;
	int day;
};
```

- 所以就要这样写才可以，

```cpp
class Date
{
	void Init(int year,int month,int day)
	{
		_year = year;
		_month = month;
		_day = day;
	}
	int _year;
	int _month;
	int _day;
};
```

- 这个时候我们是不是可以使用这个类里的函数了~~

```cpp
int main()
{
	Date d1;
	d1.Init(2024, 1, 26);
	return 0;
}
```

- 我们使用发现是报错了，这提示的是啥啊~

![在这里插入图片描述](https://img-blog.csdnimg.cn/direct/62fd21cdd17540ea9e20e3a0acade2c2.png)


>C++提出了三种访问限定符，接下来我们再来看一下：

## 三、类的访问限定符及封装

### 访问限定符

- C++实现封装的方式：**用类将对象的属性与方法结合在一块，让对象更加完善，通过访问权限选择性的将其接口提供给外部的用户使用。**


![在这里插入图片描述](https://img-blog.csdnimg.cn/direct/f904810c5ab94c1d9040f5b8ad4efbf9.png)

【访问限定符说明】

1. **public修饰的成员在类外可以直接被访问**

2. **protected和private修饰的成员在类外不能直接被访问(此处protected和private是类似的)**
3. **访问权限作用域从该访问限定符出现的位置开始直到下一个访问限定符出现时为止**
4. **如果后面没有访问限定符，作用域就到 } 即类结束。**
5. **class的默认访问权限为private，struct为public(因为struct要兼容C)**

注意：访问限定符只在编译时有用，当数据映射到内存后，没有任何访问限定符上的区别


>上面的代码就可以这样写了：


```cpp
class Date
{
	// public公有,会一直修饰到结束或者遇到下一个限定符
public:
	void Init(int year,int month,int day)
	{
		_year = year;
		_month = month;
		_day = day;
	}
	int _year;
	int _month;
	int _day;
};
int main()
{
	Date d1;
	class Date d2; // 这样也是可以的
	d1.Init(2024, 1, 26);
	d2._day++;
	return 0;
}
```

- 或者来看这个：
  - 就算是改成`struct`也是一样的


![在这里插入图片描述](https://img-blog.csdnimg.cn/direct/ff612c5777134eeda485eb70aeb3bf31.png)

- 那我再添加一个函数，放到最上面上面，他可以访问吗？
  - 很显然是可以的，因为没有访问限定符限制，是定义的struct默认是公开的，如果是class就是私有的


![在这里插入图片描述](https://img-blog.csdnimg.cn/direct/ce07f033f5f94d23aad60328a06350e7.png)

- class就无法访问，不多介绍~~


![在这里插入图片描述](https://img-blog.csdnimg.cn/direct/c09cea6679e345c8ab7e41f09339ade3.png)


- 假设一个类比较大，需要进行声明和定义分离，怎么办？
- 这里可以看到报错了，原因是编译器搜索的时候是在默认和全局里搜索，默认不会在类里面搜索，搜索不到就报错了

![在这里插入图片描述](https://img-blog.csdnimg.cn/direct/0ded3ad7b2a84a32be2997b8af39325b.png)


- 这个时候加上一个`::`，这里就好像命名空间域一样，指定搜索
- 这个时候加上了又报了一个错误，我们之前讲过的，**缺省参数不能在声明和定义里同时给**

![在这里插入图片描述](https://img-blog.csdnimg.cn/direct/8774adda13ae452e951211fbfeeb7e0f.png)
- 再次改进后：

![在这里插入图片描述](https://img-blog.csdnimg.cn/direct/5557f57452814f4e8427e5a3ca44b690.png)

- 优先会在指定域里面找，找不到然后再从局部里找，然后再从全局里找~~


---
### 【面试题】C++中struct和class的区别

问题：**C++中struct和class的区别是什么？**

- 解答： **C++需要兼容C语言，所以C++中struct可以当成结构体使用。另外C++中struct还可以用来定义类。和class定义类是一样的，区别是`struct定义的类默认访问权限是public`，`class定义的类默认访问权限是private`。注意：在继承和模板参数列表位置，struct和class也有区别，后序给大家介绍。**

### 3.5 类的两种定义方式

1. 声明和定义全部放在类体中，需注意：**成员函数如果在类中定义，编译器可能会将其当成内联函数处理。**

![在这里插入图片描述](https://img-blog.csdnimg.cn/direct/d320a230626e457d8ce225038f2445e1.png)

2. 类声明放在 **.h**文件中，成员函数定义放在 **.cpp**文件中，注意： **成员函数名前需要加类名`::`**

![在这里插入图片描述](https://img-blog.csdnimg.cn/direct/6a6b07ba23084bd8a0746d0f3504e3b1.png)

- **一般情况下，更期望采用第二种方式**


## 四、封装

### 【面试题】面向对象的三大特性

- 面向对象的三大特性：**封装、继承、多态。**

1. C++**数据**和**方法**都放到类里面
2. C++访问限定符去对成员进行限制，想给你访问是公有，不想给你访问是私有



> 在类和对象阶段，主要是研究类的封装特性，那什么是封装呢？

**封装：将数据和操作数据的方法进行有机结合，隐藏对象的属性和实现细节，仅对外公开接口来和对象进行交互。**


- **封装本质上是一种管理，让用户更方便使用类**。比如：对于电脑这样一个复杂的设备，提供给用户的就只有开关机键、通过键盘输入，显示器，USB插孔等，让用户和计算机进行交互，完成日常事务。但实际上电脑真正工作的却是CPU、显卡、内存等一些硬件元件。

- 对于计算机使用者而言，不用关心内部核心部件，比如主板上线路是如何布局的，CPU内部是如何设计的等，用户只需要知道，怎么开机、怎么通过键盘和鼠标与计算机进行交互即可。因此计算机厂商在出厂时，在外部套上壳子，将内部实现细节隐藏起来，仅仅对外提供开关机、鼠标以及键盘插孔等，让用户可以与计算机进行交互即可。

**在C++语言中实现封装，可以通过类将数据以及操作数据的方法进行隐藏对象内部实现细节，控制哪些方法可以在类外部直接被使用**

## 五、类的作用域
- 类定义了一个新的作用域，类的所有成员都在类的作用域中。在类体外定义成员时，需要使用 ::作用域操作符指明成员属于哪个类域。

```cpp
class Person
{
public:
	void PrintPersonInfo();
private:
	// 这个是声明
	char _name[20];
	char _gender[3];
	int _age;
};
// 这里需要指定PrintPersonInfo是属于Person这个类域
void Person::PrintPersonInfo()
{
	cout << _name << " " << _gender << " " << _age << endl;
}
```

## 六、类的实例化

**用类类型创建对象的过程，称为类的实例化**


1. 类是对对象进行描述的，是一个模型一样的东西，限定了类有哪些成员，定义出一个类并没有分配实际的内存空间来存储它；比如：入学时填写的学生信息表，表格就可以看成是一个类，来描述具体学生信息。
2. 一个类可以实例化出多个对象，实例化出的对象 占用实际的物理空间，存储类成员变量


```cpp
int main()
{
	Person._age = 100; // 编译失败：error C2059: 语法错误:“.”
	return 0;
}
```

- 类里面定义的成员是声明，是没有空间的

- ![在这里插入图片描述](https://img-blog.csdnimg.cn/direct/1e32fbd5b0544e47beeff82f13c960ce.png)

- 写成这样，实例化就可以了

![在这里插入图片描述](https://img-blog.csdnimg.cn/direct/599c03ed4d87413ab7ad82bae87931c1.png)

- Person类是没有空间的，只有Person类实例化出的对象才有具体的年龄。


3. 做个比方。类实例化出对象就像现实中使用建筑设计图建造出房子，类就像是设计图，只设计出需要什么东西，但是并没有实体的建筑存在，同样类也只是一个设计，实例化出的对象才能实际存储数据，占用物理空间



![在这里插入图片描述](https://img-blog.csdnimg.cn/direct/3d5f8964b59748f3901761c653ca6daf.png)



![在这里插入图片描述](https://img-blog.csdnimg.cn/direct/fddfea984b5e49cb94b67f0b3a6347f4.png)

## 七、类对象模型

> 问题：类中既可以有成员变量，又可以有成员函数，那么一个类的对象中包含了什么？如何计算一个类的大小？


### 类对象的存储方式猜测


- 对象中包含类的各个成员


![在这里插入图片描述](https://img-blog.csdnimg.cn/direct/d0af26f9df714ec9ab10196b4ffc5914.png)

**缺陷**：每个对象中成员变量是不同的，但是调用同一份函数，如果按照此种方式存储，当一个类创建多个对象时，每个对象中都会保存一份代码，相同代码保存多次，浪费空间。那么如何解决呢？

- 代码只保存一份，在对象中保存存放代码的地址

![在这里插入图片描述](https://img-blog.csdnimg.cn/direct/df4b242498ba48d186e4fc5d6e603567.png)

- 只保存成员变量，成员函数存放在公共的代码段

![在这里插入图片描述](https://img-blog.csdnimg.cn/direct/c89cf2a4d8654fb5b61c762352f3244c.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/direct/679a68afb19d451d90fef9be8400c30e.png)



- 问题：对于上述三种存储方式，那计算机到底是按照那种方式来存储的？

我们再通过对下面的不同对象分别获取大小来分析看下：


```cpp
class Date
{
	void Init(int year, int month, int day)
	{
		_year = year;
		_month = month;
		_day = day;
	}
	int _year;
	int _month;
	int _day;
};

int main()
{
	Date d1;
	cout << sizeof(d1) << endl;
}
```

- 可以清楚的看到，这就是三个成员的大小，而函数是没有算进去的

![在这里插入图片描述](https://img-blog.csdnimg.cn/direct/31be8270903d43dc9ace0c20c1aafa5d.png)

- 结论：**一个类的大小，实际就是该类中”成员变量”之和，当然要注意内存对齐注意空类的大小【与C语言一样】，空类比较特殊，编译器给了空类一个字节来唯一标识这个类的对象。**


>我们再次回忆一下
### 结构体内存对齐规则


1. 第一个成员在与结构体**偏移量为0**的地址处。
2. 其他成员变量要对齐到某个数字（对齐数）的整数倍的地址处。
- 注意：对齐数 = 编译器默认的一个对齐数与该成员大小的较小值。VS中**默认的对齐数为8**
3. 结构体总大小为：**最大对齐数**（所有变量类型最大者与默认对齐参数取最小）的整数倍。
4. 如果嵌套了结构体的情况，嵌套的结构体对齐到自己的最大对齐数的整数倍处，结构体的整体大小就是所有最大对齐数（含嵌套结构体的对齐数）的整数倍。

### 【面试题】
1. 结构体怎么对齐？ 为什么要进行内存对齐？
2. 如何让结构体按照指定的对齐参数进行对齐？能否按照3、4、5即任意字节对齐？
3. 什么是大小端？如何测试某台机器是大端还是小端，有没有遇到过要考虑大小端的场景
